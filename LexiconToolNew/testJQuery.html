<html>
<head>

<style>

#top {
 width: 100%;
 height: 300px;
 border: 1px solid #456987;
}

#draggable {
 border: 1px solid #456987;
}

#middle {
 width: 100%;
 height: 30px;
 border: 1px solid #456987;
}

#bottom {
 width: 100%;
 height: 300px;
 border: 1px solid #456987;
}

</style>

<script type="text/javascript" src="jquery/js/jquery-1.5.1.min.js"></script>
<script type="text/javascript" src="jquery/js/jquery-ui-1.8.11.custom.min.js"></script>

<script>

var iStartHeight = 0;

$(function() {
 $( "#draggable" ).draggable({axis: "y",
                              start: function(event, ui) { startDragging(ui); },
                               drag: function(event, ui) { resizeWindowParts(ui); } });
});

function startDragging(ui) {
 iStartHeight = document.getElementById('top').offsetHeight;
}

function resizeWindowParts(ui) {
 var oTop = document.getElementById('top'); 
 var oBottom = document.getElementById('bottom'); 
 var iNewTopHeight = iStartHeight + ui.position.top;
 var iNewBottomHeight = iStartHeight - ui.position.top;
 oTop.style.height = iNewTopHeight + 'px';
 oBottom.style.height = iNewBottomHeight + 'px';
 ui.position.top = 0;
}

</script>


</head>
<body>

<div id=top>
Top
</div>

<div id=middle>
  Middle1
  <span id=draggable>Drag</span>
  Middle2
</div>

<div id=bottom>
Bottom
</div>

</body>
</html>
